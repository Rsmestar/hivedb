# توثيق واجهة برمجة التطبيقات (API) لـ HiveDB

## مقدمة

توفر HiveDB واجهة برمجة تطبيقات RESTful قوية ومرنة تتفوق على Directus من خلال نموذج البيانات السداسي الفريد. تتيح هذه الواجهة للمطورين إمكانية التفاعل مع قاعدة البيانات السداسية بطرق متعددة ومبتكرة.

## نقاط النهاية الأساسية

### المصادقة والتفويض

| النقطة النهائية | الطريقة | الوصف |
|--------------|--------|---------|
| `/api/auth/register` | POST | تسجيل مستخدم جديد |
| `/api/auth/login` | POST | تسجيل الدخول والحصول على رمز JWT |
| `/api/auth/refresh` | POST | تحديث رمز الوصول |
| `/api/auth/me` | GET | الحصول على معلومات المستخدم الحالي |

### إدارة الخلايا السداسية

| النقطة النهائية | الطريقة | الوصف |
|--------------|--------|---------|
| `/api/hives` | GET | الحصول على قائمة الخلايا الرئيسية |
| `/api/hives` | POST | إنشاء خلية رئيسية جديدة |
| `/api/hives/{hive_id}` | GET | الحصول على تفاصيل خلية رئيسية |
| `/api/hives/{hive_id}` | PUT | تحديث خلية رئيسية |
| `/api/hives/{hive_id}` | DELETE | حذف خلية رئيسية |
| `/api/hives/{hive_id}/cells` | GET | الحصول على قائمة الخلايا الفرعية |
| `/api/cells` | POST | إنشاء خلية جديدة |
| `/api/cells/{cell_id}` | GET | الحصول على تفاصيل خلية |
| `/api/cells/{cell_id}` | PUT | تحديث خلية |
| `/api/cells/{cell_id}` | DELETE | حذف خلية |
| `/api/cells/{cell_id}/data` | GET | الحصول على بيانات الخلية |
| `/api/cells/{cell_id}/data` | POST | إضافة بيانات للخلية |
| `/api/cells/{cell_id}/data/{key}` | GET | الحصول على قيمة محددة من بيانات الخلية |
| `/api/cells/{cell_id}/data/{key}` | PUT | تحديث قيمة محددة في بيانات الخلية |
| `/api/cells/{cell_id}/data/{key}` | DELETE | حذف قيمة محددة من بيانات الخلية |

### الاستعلامات المتقدمة (تتفوق على Directus)

| النقطة النهائية | الطريقة | الوصف |
|--------------|--------|---------|
| `/api/query/neighbors` | POST | البحث عن الخلايا المجاورة لخلية محددة |
| `/api/query/path` | POST | البحث عن المسار بين خليتين |
| `/api/query/pattern` | POST | البحث عن أنماط محددة في الشبكة السداسية |
| `/api/query/aggregate` | POST | إجراء عمليات تجميع على مجموعة من الخلايا |
| `/api/query/spatial` | POST | إجراء استعلامات مكانية على الشبكة السداسية |

## أمثلة على الاستخدام

### تسجيل مستخدم جديد

```http
POST /api/auth/register
Content-Type: application/json

{
  "email": "user@example.com",
  "password": "SecurePassword123",
  "name": "مستخدم جديد"
}
```

### إنشاء خلية رئيسية جديدة

```http
POST /api/hives
Content-Type: application/json
Authorization: Bearer {token}

{
  "name": "خلية البيانات الرئيسية",
  "description": "تخزين البيانات الأساسية للتطبيق"
}
```

### إنشاء خلية فرعية

```http
POST /api/cells
Content-Type: application/json
Authorization: Bearer {token}

{
  "hive_id": "123e4567-e89b-12d3-a456-426614174000",
  "data_type": "json",
  "coordinates": "0,0",
  "data": {
    "name": "بيانات المستخدمين",
    "description": "معلومات المستخدمين الأساسية"
  }
}
```

### البحث عن الخلايا المجاورة

```http
POST /api/query/neighbors
Content-Type: application/json
Authorization: Bearer {token}

{
  "cell_id": "123e4567-e89b-12d3-a456-426614174000",
  "depth": 2,
  "filter": {
    "data_type": "json"
  }
}
```

### البحث عن نمط محدد

```http
POST /api/query/pattern
Content-Type: application/json
Authorization: Bearer {token}

{
  "center": {
    "type": "user"
  },
  "neighbors": [
    {
      "direction": "north",
      "type": "document"
    },
    {
      "direction": "southeast",
      "type": "metadata",
      "data": {
        "status": "active"
      }
    }
  ]
}
```

## ميزات متقدمة تتفوق على Directus

### 1. استعلامات العلاقات السداسية

على عكس Directus الذي يعتمد على العلاقات التقليدية (one-to-many, many-to-many)، توفر HiveDB علاقات سداسية في 6 اتجاهات مختلفة، مما يتيح نمذجة أكثر تعقيدًا وواقعية للبيانات.

### 2. الاستعلامات المكانية

تدعم HiveDB استعلامات مكانية متقدمة على الشبكة السداسية، مثل:
- البحث عن أقرب الخلايا
- تحديد المناطق المتصلة
- حساب المسافات والمسارات

### 3. التخزين المؤقت السائل (Liquid Cache)

نظام تخزين مؤقت ذكي يتكيف مع أنماط الاستخدام ويحسن أداء الاستعلامات بشكل ديناميكي.

### 4. محسن الاستعلامات الذكي

يقوم بتحليل وتحسين الاستعلامات تلقائيًا بناءً على بنية البيانات السداسية.

### 5. دعم متعدد اللغات

واجهة برمجة تطبيقات متعددة اللغات مع دعم كامل للغة العربية والعديد من اللغات الأخرى.

## أمان API

تستخدم HiveDB عدة طبقات من الأمان لحماية البيانات:

1. **مصادقة JWT**: رموز مصادقة آمنة مع صلاحية محدودة
2. **تشفير البيانات**: تشفير البيانات الحساسة في قاعدة البيانات
3. **تحكم دقيق بالصلاحيات**: نظام صلاحيات متقدم على مستوى الخلية والحقل
4. **سجل التدقيق**: تتبع كامل لجميع العمليات على قاعدة البيانات
5. **حماية من هجمات CSRF و XSS**: تدابير أمان متقدمة ضد الهجمات الشائعة

## الاختلافات الرئيسية عن Directus

| الميزة | HiveDB | Directus |
|--------|--------|----------|
| نموذج البيانات | سداسي مع علاقات في 6 اتجاهات | علائقي تقليدي |
| استعلامات مكانية | مدعومة بالكامل | محدودة |
| تخزين مؤقت | تخزين مؤقت سائل ذكي | تخزين مؤقت بسيط |
| محسن الاستعلامات | محسن متقدم للشبكة السداسية | محسن SQL تقليدي |
| دعم اللغة العربية | مدعوم بالكامل | محدود |
| واجهة مستخدم | واجهة سداسية تفاعلية | واجهة تقليدية |
| استعلامات الأنماط | مدعومة بالكامل | غير مدعومة |
| أداء الاستعلامات المعقدة | عالي | متوسط |

## متطلبات النظام

- Node.js 14.0 أو أحدث
- PostgreSQL 12.0 أو أحدث
- 2GB RAM على الأقل
- 1GB مساحة تخزين على الأقل

## الخاتمة

توفر واجهة برمجة التطبيقات لـ HiveDB تجربة مطور متفوقة على Directus من خلال نموذج البيانات السداسي الفريد والاستعلامات المتقدمة والأداء العالي. يمكن للمطورين الاستفادة من هذه الميزات لبناء تطبيقات أكثر تعقيدًا وكفاءة.
